// Lumy TV - Internationalization System
const translations = {
  en: {
    // Navigation
    nav: {
      useCases: "Use Cases",
      pricing: "Pricing",
      partners: "Partners",
      contact: "Contact",
      requestDemo: "Request Demo",
      darkMode: "Dark mode",
      lightMode: "Light mode",
      menu: "Menu"
    },
    
    // Hero Section
    hero: {
      badge: "Digital Signage Solution",
      title: "Effortless Digital Signage for Businesses of All Sizes",
      description: "Transform your communication with intelligent digital screens. Update content in real-time, synchronize multiple displays, and automate everything with powerful integrations.",
      stats: {
        activeScreens: "Active Screens",
        uptime: "Uptime",
        support: "Support"
      },
      actions: {
        startTrial: "Start Free Trial",
        viewPricing: "View Pricing"
      },
      note: "No credit card required • Setup in 5 minutes"
    },
    
    // How It Works Section
    howItWorks: {
      title: "How It Works",
      subtitle: "Get started with digital signage in three simple steps",
      steps: {
        upload: {
          title: "Upload Your Content",
          description: "Add images, videos, and create custom templates with our intuitive content management system."
        },
        create: {
          title: "Create Playlists",
          description: "Organize your content into dynamic playlists with scheduling and automation features."
        },
        manage: {
          title: "Manage Remotely",
          description: "Control all your screens from anywhere with real-time updates and IFTTT automation."
        }
      }
    },
    
    // Features Section
    features: {
      title: "Powerful Features",
      subtitle: "Everything you need for professional digital signage",
      cms: {
        title: "Smart Content Management",
        description: "Comprehensive CMS with advanced features for professional digital signage",
        features: [
          "Flexible user management",
          "Multi-screen synchronization",
          "Custom HTML5 templates",
          "Content scheduling & loops",
          "Screen splitting capabilities",
          "RSS feeds & live tickers"
        ]
      },
      automation: {
        title: "Smart Automation",
        description: "React to events with geolocation, beacons, motion sensors, and voice commands for dynamic content delivery."
      },
      ifttt: {
        title: "IFTTT Integration",
        description: "Automate workflows with powerful triggers and connected actions for seamless operation."
      }
    },
    
    // Testimonials Section
    testimonials: {
      title: "Trusted by Businesses Worldwide",
      subtitle: "See what our customers say about Lumy TV",
      reviews: [
        {
          content: "Lumy TV transformed our customer communication. The real-time updates and automation features have increased our engagement by 300%.",
          author: "João Silva",
          position: "Marketing Director, RetailCorp"
        },
        {
          content: "The IFTTT integration is game-changing. We can now automate our entire digital signage workflow based on real-world events.",
          author: "Maria Costa",
          position: "Operations Manager, TechHub"
        },
        {
          content: "Setup was incredibly easy, and the multi-screen synchronization works flawlessly across our 50+ locations.",
          author: "Pedro Rodrigues",
          position: "IT Director, ChainStore"
        }
      ]
    },
    
    // CTA Section
    cta: {
      title: "Ready to Transform Your Digital Communication?",
      description: "Join hundreds of businesses using Lumy TV to create engaging digital experiences.",
      actions: {
        startTrial: "Start Free Trial",
        contactSales: "Contact Sales"
      },
      features: [
        "Free 14-day trial",
        "No setup fees",
        "24/7 support"
      ]
    },
    
    // Footer
    footer: {
      copyright: "© {year} Lumy TV",
      siteMap: "Site map",
      socialMedia: "Social media"
    },
    
    // Accessibility
    accessibility: {
      skipToContent: "Skip to content"
    },
    
    // Image descriptions for placeholders
    images: {
      heroMockup: "[IMAGE PLACEHOLDER: Digital signage dashboard interface showing real-time content management and multiple screen displays]",
      uploadIcon: "[IMAGE PLACEHOLDER: Upload icon representing content management system]",
      playlistIcon: "[IMAGE PLACEHOLDER: Playlist icon representing content organization and scheduling]",
      remoteIcon: "[IMAGE PLACEHOLDER: Remote management icon representing wireless control and automation]",
      cmsIcon: "[IMAGE PLACEHOLDER: Content management system icon with advanced features]",
      automationIcon: "[IMAGE PLACEHOLDER: Smart automation icon with sensors and triggers]",
      iftttIcon: "[IMAGE PLACEHOLDER: IFTTT integration icon showing connected workflows]"
    }
  },
  
  pt: {
    // Navegação
    nav: {
      useCases: "Casos de Uso",
      pricing: "Preços",
      partners: "Parceiros",
      contact: "Contacto",
      requestDemo: "Peça uma Demo",
      darkMode: "Modo escuro",
      lightMode: "Modo claro",
      menu: "Menu"
    },
    
    // Seção Hero
    hero: {
      badge: "Solução de Digital Signage",
      title: "Digital Signage Eficaz para Empresas de Todos os Tamanhos",
      description: "Transforme a sua comunicação com ecrãs digitais inteligentes. Atualize conteúdo em tempo real, sincronize múltiplos displays e automatize tudo com integrações poderosas.",
      stats: {
        activeScreens: "Ecrãs Ativos",
        uptime: "Disponibilidade",
        support: "Suporte"
      },
      actions: {
        startTrial: "Iniciar Teste Gratuito",
        viewPricing: "Ver Preços"
      },
      note: "Sem cartão de crédito • Configuração em 5 minutos"
    },
    
    // Seção Como Funciona
    howItWorks: {
      title: "Como Funciona",
      subtitle: "Comece com digital signage em três passos simples",
      steps: {
        upload: {
          title: "Carregue o Seu Conteúdo",
          description: "Adicione imagens, vídeos e crie templates personalizados com o nosso sistema de gestão de conteúdo intuitivo."
        },
        create: {
          title: "Crie Playlists",
          description: "Organize o seu conteúdo em playlists dinâmicas com funcionalidades de agendamento e automação."
        },
        manage: {
          title: "Gerir Remotamente",
          description: "Controle todos os seus ecrãs de qualquer lugar com atualizações em tempo real e automação IFTTT."
        }
      }
    },
    
    // Seção Funcionalidades
    features: {
      title: "Funcionalidades Poderosas",
      subtitle: "Tudo o que precisa para digital signage profissional",
      cms: {
        title: "Gestão Inteligente de Conteúdo",
        description: "CMS abrangente com funcionalidades avançadas para digital signage profissional",
        features: [
          "Gestão flexível de utilizadores",
          "Sincronização multi-ecrã",
          "Templates HTML5 personalizados",
          "Agendamento e loops de conteúdo",
          "Capacidades de divisão de ecrã",
          "Feeds RSS e tickers ao vivo"
        ]
      },
      automation: {
        title: "Automação Inteligente",
        description: "Reaja a eventos com geolocalização, beacons, sensores de movimento e comandos de voz para entrega dinâmica de conteúdo."
      },
      ifttt: {
        title: "Integração IFTTT",
        description: "Automatize fluxos de trabalho com triggers poderosos e ações conectadas para operação perfeita."
      }
    },
    
    // Seção Testemunhos
    testimonials: {
      title: "Confiado por Empresas em Todo o Mundo",
      subtitle: "Veja o que os nossos clientes dizem sobre a Lumy TV",
      reviews: [
        {
          content: "A Lumy TV transformou a nossa comunicação com clientes. As atualizações em tempo real e funcionalidades de automação aumentaram o nosso envolvimento em 300%.",
          author: "João Silva",
          position: "Diretor de Marketing, RetailCorp"
        },
        {
          content: "A integração IFTTT é revolucionária. Agora podemos automatizar todo o nosso fluxo de trabalho de digital signage baseado em eventos do mundo real.",
          author: "Maria Costa",
          position: "Gestora de Operações, TechHub"
        },
        {
          content: "A configuração foi incrivelmente fácil, e a sincronização multi-ecrã funciona perfeitamente nas nossas mais de 50 localizações.",
          author: "Pedro Rodrigues",
          position: "Diretor de TI, ChainStore"
        }
      ]
    },
    
    // Seção CTA
    cta: {
      title: "Pronto para Transformar a Sua Comunicação Digital?",
      description: "Junte-se a centenas de empresas que usam a Lumy TV para criar experiências digitais envolventes.",
      actions: {
        startTrial: "Iniciar Teste Gratuito",
        contactSales: "Contactar Vendas"
      },
      features: [
        "Teste gratuito de 14 dias",
        "Sem taxas de configuração",
        "Suporte 24/7"
      ]
    },
    
    // Rodapé
    footer: {
      copyright: "© {year} Lumy TV",
      siteMap: "Mapa do site",
      socialMedia: "Redes sociais"
    },
    
    // Acessibilidade
    accessibility: {
      skipToContent: "Saltar para o conteúdo"
    },
    
    // Descrições de imagens para placeholders
    images: {
      heroMockup: "[PLACEHOLDER IMAGEM: Interface do dashboard de digital signage mostrando gestão de conteúdo em tempo real e múltiplos displays]",
      uploadIcon: "[PLACEHOLDER IMAGEM: Ícone de upload representando sistema de gestão de conteúdo]",
      playlistIcon: "[PLACEHOLDER IMAGEM: Ícone de playlist representando organização de conteúdo e agendamento]",
      remoteIcon: "[PLACEHOLDER IMAGEM: Ícone de gestão remota representando controlo sem fios e automação]",
      cmsIcon: "[PLACEHOLDER IMAGEM: Ícone do sistema de gestão de conteúdo com funcionalidades avançadas]",
      automationIcon: "[PLACEHOLDER IMAGEM: Ícone de automação inteligente com sensores e triggers]",
      iftttIcon: "[PLACEHOLDER IMAGEM: Ícone de integração IFTTT mostrando fluxos de trabalho conectados]"
    }
  }
};

// Internationalization class
class I18n {
  constructor() {
    this.currentLanguage = this.detectLanguage();
    this.translations = translations;
  }
  
  detectLanguage() {
    // Check URL parameter first
    const urlParams = new URLSearchParams(window.location.search);
    const urlLang = urlParams.get('lang');
    if (urlLang && this.translations[urlLang]) {
      return urlLang;
    }
    
    // Check localStorage
    const storedLang = localStorage.getItem('language');
    if (storedLang && this.translations[storedLang]) {
      return storedLang;
    }
    
    // Check browser language (default to English as specified)
    const browserLang = navigator.language || navigator.userLanguage;
    if (browserLang.startsWith('pt')) {
      return 'pt';
    }
    
    // Default to English
    return 'en';
  }
  
  setLanguage(lang) {
    if (!this.translations[lang]) {
      console.warn(`Language ${lang} not supported`);
      return;
    }
    
    this.currentLanguage = lang;
    localStorage.setItem('language', lang);
    
    // Update HTML lang attribute
    document.documentElement.lang = lang;
    
    // Update page content
    this.updateContent();
    
    // Update URL without page reload
    const url = new URL(window.location);
    url.searchParams.set('lang', lang);
    window.history.replaceState({}, '', url);
  }
  
  t(key) {
    const keys = key.split('.');
    let value = this.translations[this.currentLanguage];
    
    for (const k of keys) {
      if (value && typeof value === 'object') {
        value = value[k];
      } else {
        console.warn(`Translation key not found: ${key} for language ${this.currentLanguage}`);
        return key;
      }
    }
    
    return value || key;
  }
  
  updateContent() {
    // Update all elements with data-i18n attribute
    const elements = document.querySelectorAll('[data-i18n]');
    elements.forEach(el => {
      const key = el.getAttribute('data-i18n');
      const translation = this.t(key);
      
      if (el.tagName === 'INPUT' && el.type === 'submit') {
        el.value = translation;
      } else if (el.hasAttribute('placeholder')) {
        el.placeholder = translation;
      } else if (el.hasAttribute('alt')) {
        el.alt = translation;
      } else if (el.hasAttribute('title')) {
        el.title = translation;
      } else {
        el.textContent = translation;
      }
    });
    
    // Update elements with data-i18n-html for HTML content
    const htmlElements = document.querySelectorAll('[data-i18n-html]');
    htmlElements.forEach(el => {
      const key = el.getAttribute('data-i18n-html');
      const translation = this.t(key);
      el.innerHTML = translation;
    });
    
    // Update meta tags
    this.updateMetaTags();
    
    // Update pricing text
    this.updatePricingText();
    
    // Update copyright year
    this.updateCopyright();
  }
  
  updateMetaTags() {
    const titleEl = document.querySelector('title');
    const descEl = document.querySelector('meta[name="description"]');
    const ogTitleEl = document.querySelector('meta[property="og:title"]');
    const ogDescEl = document.querySelector('meta[property="og:description"]');
    
    if (this.currentLanguage === 'en') {
      if (titleEl) titleEl.textContent = 'Lumy TV – Effortless Digital Signage for Businesses';
      if (descEl) descEl.content = 'Transform your communication with intelligent digital screens. Update content in real-time, synchronize multiple displays, and automate everything with powerful integrations.';
      if (ogTitleEl) ogTitleEl.content = 'Lumy TV – The Power of Digital Communication';
      if (ogDescEl) ogDescEl.content = 'Intelligent digital screens with real-time management and IFTTT automation.';
    } else {
      if (titleEl) titleEl.textContent = 'Lumy TV – Digital Signage Eficaz para Empresas';
      if (descEl) descEl.content = 'Transforme a sua comunicação com ecrãs digitais inteligentes. Atualize conteúdo em tempo real, sincronize múltiplos displays e automatize tudo com integrações poderosas.';
      if (ogTitleEl) ogTitleEl.content = 'Lumy TV – A força da comunicação digital';
      if (ogDescEl) ogDescEl.content = 'Ecrãs digitais inteligentes com gestão em tempo real e automação com IFTTT.';
    }
  }
  
  updatePricingText() {
    // Update pricing calculator text if present
    const priceOutputs = document.querySelectorAll('[data-price-output]');
    priceOutputs.forEach(output => {
      const currentText = output.textContent;
      if (currentText.includes('€')) {
        const isAnnual = currentText.includes('ano') || currentText.includes('year');
        const price = currentText.match(/€[\d,]+(\.\d{2})?/)?.[0] || '';
        
        if (this.currentLanguage === 'en') {
          output.textContent = price + (isAnnual ? ' / year' : ' / month');
        } else {
          output.textContent = price + (isAnnual ? ' / ano' : ' / mês');
        }
      }
    });
  }
  
  updateCopyright() {
    const yearEl = document.getElementById('y');
    if (yearEl) {
      const year = new Date().getFullYear();
      const copyrightText = this.t('footer.copyright').replace('{year}', year);
      yearEl.parentNode.textContent = copyrightText;
    }
  }
  
  getAvailableLanguages() {
    return Object.keys(this.translations);
  }
}

// Initialize i18n system
window.i18n = new I18n();